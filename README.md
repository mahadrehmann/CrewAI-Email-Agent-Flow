# ðŸ“§ CrewAI Weekly Email Scheduler

This project allows you to schedule **automated weekly email updates** generated by [CrewAI](https://docs.crewai.com/) using a simple **Flask-based form UI**. You specify the email time, day, and data file, and the agent handles everything â€” from crafting a report to sending it with attachments.

---

## ðŸš€ Features

- âœ… Web form to schedule emails
- ðŸ¤– AI-generated email content using CrewAI
- ðŸ“… Automatically runs every week at scheduled time
- ðŸ“Ž Supports file attachments
- ðŸ’¬ Fun, dynamic email tone based on document content
- ðŸ” Uses Microsoft Graph API for email delivery

---

## ðŸ“¦ Project Structure

```yaml
.
â”œâ”€â”€ crewai_config/
â”‚   â””â”€â”€ agents, tasks, and crew config files
â”œâ”€â”€ static/
â”‚   â””â”€â”€ style.css (optional)
â”œâ”€â”€ templates/
â”‚   â””â”€â”€ index.html (Flask form)
â”œâ”€â”€ src/
â”‚   â””â”€â”€ emailcrew/
â”‚       â””â”€â”€ main.py  # Main scheduling and sending logic
â”‚       â””â”€â”€ crew.py  # Crew and Agent Defintions
â”‚   â””â”€â”€ config/
â”‚       â””â”€â”€ agents.yaml  #agents prompts
â”‚       â””â”€â”€ tasks.yaml   #task propmts


```

---

## ðŸ› ï¸ Setup Instructions

### 1. Clone this repository

```bash
git clone https://github.com/mahadrehmann/CrewAI-Email-Agent-Flow.git
```

### 2. Create a virtual environment and activate it

```bash
python -m venv venv
source venv/bin/activate  # On Windows: venv\Scripts\activate
```

### 3. Install dependencies

```bash
pip install -r requirements.txt
```

### 4. Set up environment variables

Create a `.env` file with the following:

```env
GEMINI_API_KEY=your-gemini-key
AZURE_CLIENT_ID=your-client-id (If you opt to use Outlook, you can use gmail as well)
```

---

## ðŸ§  Memory-Level Scheduling Flow

Unlike file-based polling, this project uses **in-memory events** to wait for user input before proceeding.

---

## ðŸ§ª How to Run

```bash
crewai run
```

This will:

- Start the Flask server on `http://127.0.0.1:5000`
- Wait until you submit the schedule form
- Use CrewAI to generate an email
- Schedule and send it every week at the time you set

---

## ðŸŒ Flask Form UI

Navigate to:

```http
http://127.0.0.1:5000
```

Fill out this form:

- ðŸ“„ File path (input file with context)
- ðŸ“… Day (e.g. `monday`)
- â° Time (24h format, e.g. `14:30`)

---

## ðŸ“¤ Example Email

> **Subject**: Weekly Progress Update â€“ Done with the Email Agent  
> **To**: mahadrehman04@gmail.com  
> **Content**: A breakdown of the work performed

---

## ðŸ“Ž Attachment Format

The system attaches a summary text file (`attachment.txt`) along with the email. You can modify this in `main.py`.

---

## ðŸ§  Built With

- [CrewAI](https://crewai.com)
- [Flask](https://flask.palletsprojects.com/)
- [Microsoft Graph API](https://learn.microsoft.com/en-us/graph/overview)

---

